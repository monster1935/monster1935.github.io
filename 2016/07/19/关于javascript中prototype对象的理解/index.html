<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="记录学习、工作、生活"><title>初识javascript的prototype对象 | 李茶德的日记</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/img/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">初识javascript的prototype对象</h1><a id="logo" href="/.">李茶德的日记</a><p class="description">记录学习、工作、生活</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa null"> 首页</i></a><a href="/archives/"><i class="fa null"> 归档</i></a><a href="/about/"><i class="fa null"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1"><div class="content_container"><div class="post"><h1 class="post-title">初识javascript的prototype对象</h1><div class="post-meta">2016-07-19<span> | </span><span class="category"><a href="/categories/前端/">前端</a></span></div><div class="post-content"><p>原型链机制是javascript中实现继承的关键。对于prototype对象(原型对象)的理解至关重要。下文根据自己在开发中以及看书过程中对于prototype对象的理解整理了一些小tip。<br><a id="more"></a></p>
<h2 id="何为原型对象"><a href="#何为原型对象" class="headerlink" title="何为原型对象"></a>何为原型对象</h2><p>原型对象是什么？在《JavaScript高级编程》一书中是这样说的：</p>
<blockquote>
<p>无论什么时候，只要创建了一个新的函数，就会根据一组特定的规则为该函数创建一个prototype属性，这个属性指 向函数的原型对象。在默认情况下，所有原型对象都会自动获得一个constructor属性，这个属性包含一个指向prototype属性所在函数的指针。</p>
</blockquote>
<p>综上所述，所有的函数对象都会有一个prototype属性，该属性指向该函数的原型对象。也就是说原型对象的概念是基于函数对象来说的。</p>
<h2 id="深入理解原型对象"><a href="#深入理解原型对象" class="headerlink" title="深入理解原型对象"></a>深入理解原型对象</h2><p> javascript中一切皆对象。所有对象原型链的终点都指向Object.prototype。javascript中存在一类这样的函数，称之为构造函数。其可以通过new运算符生产对象，通过new运算符生产的对象称之为实例对象。如何理解实例对象与构造函数对象以及构造函数对象的原型对象三者之间的联系是理解javascript中原型链机制以及继承机制的关键。上文中已经提及，在函数对象中有prototype属性指向该函数的原型对象。构造函数也不例外。其原型对象往往定义了一些该构造函数中需要共享的属性。何为共享？即通过new运算符产生的实例对象对于其构造函数对象的共享，也就是平常我们所说的子类对于父类属性或者方法的共享。javascript中通常将需要一些实例的私有属性定义在构造函数中，将一些实例需要共享的属性定义在构造函数的原型对象中。比如：</p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.name = name;</span><br><span class="line">	<span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 在上述实例中的构造函数即为该模式，我们可以通过new的方式将Person实例化</p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person(<span class="string">'monster1'</span>,<span class="number">23</span>);</span><br><span class="line">person1.sayName();<span class="comment">//23</span></span><br><span class="line"><span class="keyword">var</span> person2 = <span class="keyword">new</span> Person(<span class="string">'monster2'</span>,<span class="number">24</span>);</span><br><span class="line">peroson2.sayName();<span class="comment">//24</span></span><br></pre></td></tr></table></figure>
<p> 通过new的方式实例化了两个Person对象，person1和person2。两个对象都有自己的私有属性name和age，可以通过打印person1对象来验证，两者共享sayName方法，可以通过调用该方法打印各自对象的name属性值。</p>
<h2 id="原型模式的原理"><a href="#原型模式的原理" class="headerlink" title="原型模式的原理"></a>原型模式的原理</h2><p>通过new的方式产生实例对象的过程，原理上是通过实例对象的_proto_属性建立与构造函数的原型对象之间的链接。实例对象的_proto_属性被部分浏览器实现了，但是不能访问到该属性。该属性保存的是一指针，指向构造函数的原型对象。在调用person1.sayName()方法时，javascript引擎首先查找person1的实例属性，person1的实例属性仅仅包括name和age。因此继续沿着原型链查找_proto_指向的原型对象。在原型对象中定义了该方法，因此调用sayName方法实际上是调用的构造函数的原型对象的原型方法。<strong>需要明确的是实例对象与构造函数对象之间并没有直接联系，实例对象仅仅指向的是构造函数的原型对象。</strong> 在原型对象中的constructor属性又指向了该构造函数。以上部分在《JavaScript高级编程》中给出了详细的图示。</p>
<h2 id="原型对象的constructor属性"><a href="#原型对象的constructor属性" class="headerlink" title="原型对象的constructor属性"></a>原型对象的constructor属性</h2><p>上文曾提及到，每个原型对象都会默认获得一个constructor属性，该属性指向其函数对象。此处需要注意的是给原型对象添加属性或者方法的时候以属性的方式添加不会断开与原来的原型对象之间的链接，仅仅是往原型对象中添加属性。但是通过对象字面量的方式给prototype赋值的时候会导致与原来的原型对象之间的链接断裂，这种方式相当于重写了原型对象，如果不显示赋值constructor属性的话会导致该原型对象没有constructor属性。此处理解的关键在于构造函数的prototype的属性是原型对象的一个指针。如果以对象字面量的方式指定prototype，相当于prototype重新指向了另外一个新的对象。</p>
<p>比如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.name = name;</span><br><span class="line">	<span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person(<span class="string">'monster1935'</span>,<span class="number">24</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(person1.constructor);<span class="comment">//Person</span></span><br></pre></td></tr></table></figure>
<p>如果是对象字面量的方式:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.name = name;</span><br><span class="line">	<span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">	sayName: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person(<span class="string">'monster1935'</span>,<span class="number">24</span>);</span><br><span class="line"><span class="built_in">console</span>.log(person1.constructor);<span class="comment">//Object</span></span><br><span class="line"><span class="built_in">console</span>.log(person1 <span class="keyword">instanceof</span> Person);<span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>第二种情况下重写了Person.prototype，因此其原型对象中默认不再有constructor属性。</p>
<p>关于constructor属性的作用一直比较疑惑，因为在平时的开发中很少使用到该属性。该属性并且也不是一个十分可靠的值，可以通过重写prototype任意指定。但是为了养成一个良好的习惯，即使在重写prototype对象后也应该显示的指定construtor的值，这样可以更好表明该实例对象的与父类之间的联系。虽然即使不指定constructor也不会影响其类型的判定。比如在第二种情况下使用instanceof还是能表明实例与父类之间的关系。因此个人对于constructor属性存在的意义仍没有很好的体会。不过可以使用person1.constructor.prototype显示的访问构造函数的原型对象。</p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>prototype是javascript中比较重要的一个概念。对于原型的理解可以很好的把握javascript的继承机制。<br>以上文字是个人对于prototype的一些体会。晚安。</p>
</div><div class="tags"><a href="/tags/js/">js</a><a href="/tags/prototype/">prototype</a></div><div class="post-nav"><a href="/2016/09/28/数据结构中常用的几种排序算法/" class="pre">数据结构中常用的几种排序算法</a><a href="/2016/07/19/关于commonJS规范中module.exports与exports的区别/" class="next">关于CommonJS规范中module.exports与exports的区别</a></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">李茶德的日记.</a><a rel="nofollow" target="_blank" href="http://www.beian.miit.gov.cn"> 京ICP备17057625号.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>