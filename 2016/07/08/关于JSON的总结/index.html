<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="记录学习、工作、生活"><title>关于JSON的总结 | 李茶德的日记</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/img/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">关于JSON的总结</h1><a id="logo" href="/.">李茶德的日记</a><p class="description">记录学习、工作、生活</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa null"> 首页</i></a><a href="/archives/"><i class="fa null"> 归档</i></a><a href="/about/"><i class="fa null"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1"><div class="content_container"><div class="post"><h1 class="post-title">关于JSON的总结</h1><div class="post-meta">2016-07-08<span> | </span><span class="category"><a href="/categories/前端/">前端</a></span></div><div class="post-content"><p>最近学习并使用Vue的过程中，在使用Vue-resource的过程中遇到了以下问题：通过该插件异步请求数据的时候发现数据已经能正确请求到，但是无法通过response.json()解析返回体的body。通过查阅源码，发现该函数的主要作用就是将response对象中的body通过JSON.parse(this.body)解析为json对象。至于为什么会出现解析错误的情况，是因为自己写的json格式出现了错误，因此对json对象做了如下的总结。<br><a id="more"></a><br><strong>JSON格式</strong></p>
<p> <strong>1. 什么是json</strong></p>
<p> json（Javascript Object Notation）是一种用于数据交换的文本格式。2001年由Douglas Crockford提出，目的是取代繁琐笨重的XML格式。</p>
<p> <strong>2. json格式与xml的比较</strong></p>
<p> 与同样作为数据传输的格式的xml比起来，json具有以下优点：</p>
<ul>
<li>书写简单，结构清晰，轻量级</li>
<li>符合javascript的原生语法，解释器引擎可以直接处理   </li>
</ul>
<p><strong>3.   对于json格式的几个规定：</strong></p>
<ul>
<li>数组或对象的值可以是简单值也可以是复合值</li>
<li>简单值包括：字符串、数值（必须是十进制标识）、布尔值和Null，其中（NaN,Infinity,-Infinity和undefined都会被转换为null)</li>
<li>复合值包括符合json格式的数组或对象</li>
<li>数组或对象的最后一个成员后面不能加逗号</li>
<li>数组或对象之中的字符串必须使用双引号，不能使用单引号</li>
<li>对象的成员名称必须使用双引号</li>
</ul>
<p>注意:<strong>空数组或者空对象都是合格的json值，Null也是一个合格的json值</strong><br>正确的json格式，例如：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">["one", "two", "three"] //数组</span><br><span class="line"></span><br><span class="line">&#123; "one": 1, "two": 2, "three": 3 &#125;//对象，注意成员名称必须用双引号</span><br><span class="line"></span><br><span class="line">&#123;"names": ["张三", "李四"] &#125;//值为复合对象</span><br><span class="line"></span><br><span class="line">[ &#123; "name": "张三"&#125;, &#123;"name": "李四"&#125; ]//对象数组</span><br></pre></td></tr></table></figure>
<p><strong>json对象</strong></p>
<p>ES5中添加了json对象，其包含两个方法：JSON.stringify()和JSON.parse()</p>
<p><strong>1.    JSON.stringify()</strong><br>用处：将一个值转换为json格式的字符串，该字符串可以被JSON.parse()解析,需要注意以下几点：</p>
<ul>
<li>原始类型的字符串解析后会自动加上双引号</li>
<li>原始对象中如有一个成员是undefined,函数或者是xml对象，则这个成员被忽略</li>
<li>原始对象中如果数组的成员的是undefined,函数或者是xml对象，则被转换为null</li>
<li>正则表达式会被转换为空对象</li>
<li>自动忽略原始对象中不可遍历的属性</li>
<li>可以接受一个数组参数，指定需要转换成字符串的属性</li>
<li>可以接受一个函数作为参数，指定如何来转换成字符串，注意该函数是递归处理所有的键</li>
<li>如何被转换的对象中包含一个toJSON方法，则会使用该方法的返回值，将该返回值转换为字符串，忽略其他成员（可以被用来处理转换正则表达式的情况）</li>
</ul>
<p><strong>2.    JSON.parse()</strong><br>用处：用来将json格式的字符串转换为对象。如果该json字符串不符合json格式，则会报错。</p>
<p><strong>3. 示例</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(<span class="string">'abc'</span>));<span class="comment">//""abc""字符串默认加上双引号</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(<span class="number">1</span>));<span class="comment">//"1"</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(<span class="literal">false</span>) );<span class="comment">//"false"</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify([]));<span class="comment">//"[]"</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(&#123;&#125;));<span class="comment">//"&#123;&#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify([<span class="number">1</span>, <span class="string">"false"</span>, <span class="literal">false</span>]));<span class="comment">//"[1, "false", false]"</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(&#123; <span class="attr">name</span>: <span class="string">"张三"</span> &#125;));<span class="comment">//"&#123;"name":"张三"&#125;" 成员名称双引号</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(&#123;</span><br><span class="line">		    f: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</span><br><span class="line">		    a: [ <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;, <span class="literal">undefined</span> ]</span><br><span class="line">		&#125;));<span class="comment">//"&#123;"a":[null,null]&#125;"</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(<span class="regexp">/foo/</span>));<span class="comment">//"&#123;&#125;"正则表达式会被转换为空对象</span></span><br></pre></td></tr></table></figure>
<p>以上代码中需要注意：</p>
<ul>
<li>关于字符串的转换需要加双引号</li>
<li>成员名要加双引号</li>
<li>对于被转换对象中某个成员是函数、undefined、xml对象直接忽略。这三种情况在数组中出现时被转换为null</li>
<li>正则表达式会被转换为空对象</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line"><span class="built_in">Object</span>.defineProperties(obj, &#123;</span><br><span class="line">  <span class="string">'foo'</span>: &#123;</span><br><span class="line">    value: <span class="number">1</span>,</span><br><span class="line">    enumerable: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">'bar'</span>: &#123;</span><br><span class="line">    value: <span class="number">2</span>,</span><br><span class="line">    enumerable: <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(obj)); <span class="comment">// &#123;"foo":1&#125;</span></span><br></pre></td></tr></table></figure>
<p>以上代码中需要注意：JSON.stringify只能转换对象中可遍历的属性，不可遍历的属性自动忽略</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="string">'prop1'</span>: <span class="string">'value1'</span>,</span><br><span class="line">  <span class="string">'prop2'</span>: <span class="string">'value2'</span>,</span><br><span class="line">  <span class="string">'prop3'</span>: <span class="string">'value3'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> selectedProperties = [<span class="string">'prop1'</span>, <span class="string">'prop2'</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(obj, selectedProperties));<span class="comment">// "&#123;"prop1":"value1","prop2":"value2"&#125;"</span></span><br></pre></td></tr></table></figure>
<p>以上代码中需要注意：可以给JSON.stringify指定额外一个数组参数，用来指定将对象中哪些属性转换为字符串</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span>(<span class="params">key, value</span>) </span>&#123;</span><br><span class="line"> <span class="keyword">if</span> (<span class="keyword">typeof</span> value === <span class="string">"number"</span>) &#123;</span><br><span class="line">    value = <span class="number">2</span> * value;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;, change));</span><br><span class="line"><span class="comment">// '&#123;"a": 2,"b": 4&#125;'</span></span><br></pre></td></tr></table></figure>
<p>以上代码中需要注意的是：可以给JSON.stringify指定一个函数参数，用来改变转换字符串过程中的行为</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;<span class="attr">a</span>: &#123;<span class="attr">b</span>: <span class="number">1</span>&#125;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">key, value</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"["</span>+ key +<span class="string">"]:"</span> + value);</span><br><span class="line">  <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(o, f));</span><br><span class="line"><span class="comment">// []:[object Object]</span></span><br><span class="line"><span class="comment">// [a]:[object Object]</span></span><br><span class="line"><span class="comment">// [b]:1</span></span><br><span class="line"><span class="comment">// '&#123;"a":&#123;"b":1&#125;&#125;'</span></span><br></pre></td></tr></table></figure>
<p>以上代码说明了如果指定JSON.stringify的函数参数，处理函数是递归的处理每一个键值对。因此看下一个例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = &#123;<span class="attr">a</span>: <span class="number">1</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span>(<span class="params">key, value</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> value === <span class="string">"object"</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="attr">b</span>: <span class="number">2</span>&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> value * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(o,change));</span><br><span class="line"><span class="comment">// "&#123;"b": 4&#125;"</span></span><br></pre></td></tr></table></figure>
<p>在上面的代码中形象的体现了这一点，<strong>函数是递归来处理的</strong>。首先第一次递归，将该对象转换成了{b: 2},然后接下里的递归中根据该改变后的对象值进行递归，因此打印出来的是{b：4}</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">key, value</span>) </span>&#123;</span><br><span class="line"> <span class="keyword">if</span> (<span class="keyword">typeof</span>(value) == <span class="string">"string"</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(&#123; <span class="attr">a</span>:<span class="string">"abc"</span>, <span class="attr">b</span>:<span class="number">123</span> &#125;, f));</span><br><span class="line"><span class="comment">// '&#123;"b": 123&#125;'</span></span><br></pre></td></tr></table></figure>
<p>以上代码中需要注意的是：如果处理函数中返回了undefined或者没有返回值，则该属性被忽略</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(&#123; <span class="attr">p1</span>: <span class="number">1</span>, <span class="attr">p2</span>: <span class="number">2</span> &#125;, <span class="literal">null</span>, <span class="number">2</span>));</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">"&#123;</span></span><br><span class="line"><span class="comment">  "p1": 1,</span></span><br><span class="line"><span class="comment">  "p2": 2</span></span><br><span class="line"><span class="comment">&#125;"</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(&#123; <span class="attr">p1</span>:<span class="number">1</span>, <span class="attr">p2</span>:<span class="number">2</span> &#125;, <span class="literal">null</span>, <span class="string">"|-"</span>));</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">"&#123;</span></span><br><span class="line"><span class="comment">|-"p1": 1,</span></span><br><span class="line"><span class="comment">|-"p2": 2</span></span><br><span class="line"><span class="comment">&#125;"</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p>以上代码中需要注意的是：可以给JSON.stringify()指定第三个参数，用来格式化输出的字符串。如果是数字，则表示每个属性前面添加的空格，如果是字符串，则加在每行输出的前面。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(&#123;</span><br><span class="line"> toJSON: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Cool"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;));</span><br><span class="line"><span class="comment">// "Cool""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> o = &#123;</span><br><span class="line">  foo: <span class="string">'foo'</span>,</span><br><span class="line">  toJSON: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'bar'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(&#123;<span class="attr">x</span>: o&#125;));</span><br><span class="line"><span class="comment">// '&#123;"x":"bar"&#125;'</span></span><br></pre></td></tr></table></figure>
<p>以上代码中需要注意的是：如果被转换的对象中含有toJSON方法，则使用toJSON的返回值进行转换，其他属性忽略。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">RegExp</span>.prototype.toJSON = <span class="built_in">RegExp</span>.prototype.toString;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(<span class="regexp">/foo/</span>));</span><br><span class="line"><span class="comment">// "/foo/"</span></span><br></pre></td></tr></table></figure>
<p>以上代码就是toJSON的一个应用，用来对正则表达式应用JSON.stringify。</p>
<hr>
<p>该篇对于json的学习主要来源于阮一峰老师的教程。<br>参考文章：<a href="http://javascript.ruanyifeng.com/" target="_blank" rel="noopener">JavaScript 标准参考教程（alpha）</a></p>
</div><div class="tags"><a href="/tags/js/">js</a><a href="/tags/JSON/">JSON</a></div><div class="post-nav"><a href="/2016/07/11/关于javascript中构造函数返回值的问题/" class="pre">关于javascript中构造函数返回值的问题</a></div></div></div></div><div class="pure-u-1"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">李茶德的日记.</a><a rel="nofollow" target="_blank" href="http://www.beian.miit.gov.cn"> 京ICP备17057625号.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>